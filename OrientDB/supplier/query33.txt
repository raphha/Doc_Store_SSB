gc;connect remote:127.0.0.1/supplier root rasns1901;select first(line.customer.c_city) as c_city, s_city as s_city, first(line.orderdate.d_year) as year, sum(line.lo_revenue.asLong()) as revenue from (select s_city, lineorder as line from supplier where (s_city="UNITED KI1" or s_city="UNITED KI5") and lineorder.customer contains(c_city="UNITED KI1" or c_city="UNITED KI5") and lineorder.orderdate contains(d_year between 1992 and 1997) unwind line) where line.customer contains(c_city="UNITED KI1" or c_city="UNITED KI5") and line.orderdate contains(d_year between 1992 and 1997) group by line.customer.c_city, s_city, line.orderdate.d_year
