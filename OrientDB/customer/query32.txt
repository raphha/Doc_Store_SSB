gc;connect remote:127.0.0.1/customer root rasns1901;select c_city, first(line.supplier.s_city) as s_city, first(line.orderdate.d_year) as d_year, sum(line.lo_revenue.asLong()) as revenue from (select c_city, lineorder as line from customer where c_nation="UNITED STATES" and lineorder.supplier contains(s_nation="UNITED STATES") and lineorder.orderdate contains(d_year between 1992 and 1997) unwind line) where line.supplier contains(s_nation="UNITED STATES") and line.orderdate contains(d_year between 1992 and 1997) group by c_city, line.supplier.s_city, line.orderdate.d_year
