gc;connect remote:127.0.0.1/part root rasns1901;select first(line.orderdate.d_year) as d_year, first(line.supplier.s_city) as s_city, p_brand1, sum(eval('line.lo_revenue.asLong() - line.lo_supplycost.asLong()')) as revenue from (select p_brand1, lineorder as line from part where p_category="MFGR#14" and lineorder.supplier contains(s_nation="UNITED STATES") and lineorder.customer contains (c_region="AMERICA") and lineorder.orderdate contains (d_year=1997 or d_year=1998) unwind line) where line.supplier contains(s_nation="UNITED STATES") and line.customer contains (c_region="AMERICA") and line.orderdate contains (d_year=1997 or d_year=1998) group by line.orderdate.d_year, line.supplier.s_city, p_brand1 
