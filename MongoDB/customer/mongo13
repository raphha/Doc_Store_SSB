#!/bin/bash
mongo localhost:27017/customer_ssb --eval 'db.customer.aggregate([{"$match":{"$and":[ {"lineorder.orderdate.d_weeknuminyear": 6},{"lineorder.orderdate.d_year": 1994},{"lineorder.lo_discount":{"$in":[5,6,7]}},{"lineorder.lo_quantity":{"$gte":26}},{"lineorder.lo_quantity":{"$lte":35}}]}},{"$unwind": "$lineorder"}, {"$match":{"$and":[ {"lineorder.orderdate.d_weeknuminyear": 6},{"lineorder.orderdate.d_year": 1994},{"lineorder.lo_discount":{"$in":[5,6,7]}},{"lineorder.lo_quantity":{"$gte":26}},{"lineorder.lo_quantity":{"$lte":35}}]}},{"$project":{"lineorder.orderdate.d_datekey":1, "des":{"$multiply":["$lineorder.lo_extendedprice","$lineorder.lo_discount",0.01]}}},{"$group":{"_id":"null", "revenue":{"$sum":"$des"}}}]).toArray()' >>~/Documentos/benchmark/mongoDB/customermo/query/shell/resultados/query13.txt

