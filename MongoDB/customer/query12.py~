from pymongo import MongoClient
import time

def Inicio():

	client = MongoClient()

	db = client['teste']

	start = time.time()

	cursor = db.testando.aggregate([{"$match":{"$and":[{'lineorders.orderdate.d_yearmonthnum': 199401},{'lineorders.lo_discount':{"$in":[4,5,6]}},{'lineorders.lo_quantity':{"$gt":26}},{'lineorders.lo_quantity':{"$lt":35}}]}},{"$unwind": '$lineorders'}, {"$match":{"$and":[{'lineorders.orderdate.d_yearmonthnum': 199401},{'lineorders.lo_discount':{"$in":[4,5,6]}},{'lineorders.lo_quantity':{"$gt":26}},{'lineorders.lo_quantity':{"$lt":35}}]}},{"$project":{'lineorders.orderdate.d_datekey':1, "des":{"$multiply":["$lineorders.lo_extendedprice","$lineorders.lo_discount",0.01]}}},{"$group":{"_id":"null", "revenue":{"$sum":"$des"}}}])


	for document in cursor:
		print(document)

	end = time.time()

	print('tempo:'+ str(end - start))

Inicio()

#para funcionar no pymongo todos os campos tem que estar em string
