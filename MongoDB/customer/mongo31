#!/bin/bash
mongo localhost:27017/customer_ssb --eval 'db.customer.aggregate([{"$match":{"$and":[{"c_region":"ASIA"},{"lineorder.orderdate.d_year":{"$gte":1992}},{"lineorder.orderdate.d_year":{"$lte":1997}},{"lineorder.supplier.s_region":"ASIA"}]}},{"$unwind":"$lineorder"},{"$match":{"$and":[{"c_region":"ASIA"},{"lineorder.orderdate.d_year":{"$gte":1992}},{"lineorder.orderdate.d_year":{"$lte":1997}},{"lineorder.supplier.s_region":"ASIA"}]}},{"$project":{"lineorder.supplier.s_nation":1,"c_nation":1,"lineorder.orderdate.d_year":1,"lineorder.lo_revenue":1}},{"$group":{"_id":{"c_nation":"$c_nation","s_nation":"$lineorder.supplier.s_nation", "d_year": "$lineorder.orderdate.d_year"}, "revenue":{"$sum": "$lineorder.lo_revenue"}}}]).toArray()' >>~/Documentos/benchmark/mongoDB/customermo/query/shell/resultados/query31.txt

