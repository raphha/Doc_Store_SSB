#!/bin/bash
mongo localhost:27017/part --eval 'db.part.aggregate([{"$match":{"$and":[{"lineorder.orderdate.d_year":{"$gte":1992}},{"lineorder.orderdate.d_year":{"$lte":1997}},{"$or":[{"lineorder.customer.c_city":"UNITED KI1"},{"lineorder.customer.c_city":"UNITED KI5"}]},{"$or":[{"lineorder.supplier.s_city":"UNITED KI1"},{"lineorder.supplier.s_city":"UNITED KI5"}]}]}},{"$unwind":"$lineorder"},{"$match":{"$and":[{"lineorder.orderdate.d_year":{"$gte":1992}},{"lineorder.orderdate.d_year":{"$lte":1997}},{"$or":[{"lineorder.customer.c_city":"UNITED KI1"},{"lineorder.customer.c_city":"UNITED KI5"}]},{"$or":[{"lineorder.supplier.s_city":"UNITED KI1"},{"lineorder.supplier.s_city":"UNITED KI5"}]}]}},{"$project":{"lineorder.customer.c_city":1,"lineorder.supplier.s_city":1,"lineorder.orderdate.d_year":1,"lineorder.lo_revenue":1}},{"$group":{"_id":{"c_city":"$lineorder.customer.c_city", "s_city":"$lineorder.supplier.s_city","d_year": "$lineorder.orderdate.d_year"}, "revenue":{"$sum": "$lineorder.lo_revenue"}}}]).toArray()' >>~/Documentos/benchmark/mongoDB/partmo/query/shell/resultados/query33.txt

