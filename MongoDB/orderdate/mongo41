#!/bin/bash
mongo localhost:27017/orderdate --eval 'db.orderdate.aggregate([{$match:{$and:[{"lineorder.supplier.s_region": "AMERICA"},{"lineorder.customer.c_region":"AMERICA"},{$or:[{"lineorder.part.p_mfgr":"MFGR#1"},{"lineorder.part.p_mfgr":"MFGR#2"}]}]}},{$unwind:"$lineorder"},{$match:{$and:[{"lineorder.supplier.s_region": "AMERICA"},{"lineorder.customer.c_region":"AMERICA"},{$or:[{"lineorder.part.p_mfgr":"MFGR#1"},{"lineorder.part.p_mfgr":"MFGR#2"}]}]}},{$project:{d_year:1,"lineorder.customer.c_nation":1,dim:{$subtract:["$lineorder.lo_revenue","$lineorder.lo_supplycost"]}}},{$group:{_id:{d_year:"$d_year",c_nation:"$lineorder.customer.c_nation"}, profit:{$sum: "$dim"}}}]).toArray()' >>~/Documentos/benchmark/mongoDB/orderdatemo/query/shell/resultados/query41.txt

