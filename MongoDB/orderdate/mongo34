#!/bin/bash
mongo localhost:27017/orderdate --eval 'db.orderdate.aggregate([{$match:{$and:[{d_yearmonthnum :199712},{$or:[{"lineorder.supplier.s_city":"UNITED KI1"},{"lineorder.supplier.s_city":"UNITED KI5"}]},{$or:[{"lineorder.customer.c_city":"UNITED KI1"},{"lineorder.customer.c_city":"UNITED KI5"}]}]}},{$unwind:"$lineorder"},{$match:{$and:[{d_yearmonthnum :199712},{$or:[{"lineorder.supplier.s_city":"UNITED KI1"},{"lineorder.supplier.s_city":"UNITED KI5"}]},{$or:[{"lineorder.customer.c_city":"UNITED KI1"},{"lineorder.customer.c_city":"UNITED KI5"}]}]}},{$project:{"lineorder.customer.c_city":1,"lineorder.supplier.s_city":1, d_year:1,"lineorder.lo_revenue":1}},{$group:{_id:{c_city:"$lineorder.customer.c_city", s_city:"$lineorder.supplier.s_city",d_year: "$d_year"}, revenue:{$sum: "$lineorder.lo_revenue"}}}]).toArray()' >>~/Documentos/benchmark/mongoDB/orderdatemo/query/shell/resultados/query34.txt

