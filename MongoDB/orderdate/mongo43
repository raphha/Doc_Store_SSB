#!/bin/bash
mongo localhost:27017/orderdate --eval 'db.orderdate.aggregate([{$match:{$and:[{$or:[{d_year:1997},{d_year:1998}]},{"lineorder.supplier.s_nation":"UNITED STATES"},{"lineorder.customer.c_region":"AMERICA"},{"lineorder.part.p_category":"MFGR#14"}]}},{$unwind:"$lineorder"},{$match:{$and:[{$or:[{d_year:1997},{d_year:1998}]},{"lineorder.supplier.s_nation":"UNITED STATES"},{"lineorder.customer.c_region":"AMERICA"},{"lineorder.part.p_category":"MFGR#14"}]}},{$project:{d_year:1,"lineorder.supplier.s_city":1,"lineorder.part.p_brand1":1,dim:{$subtract:["$lineorder.lo_revenue","$lineorder.lo_supplycost"]}}},{$group:{_id:{d_year:"$d_year",s_city:"$lineorder.supplier.s_city",p_brand1:"$lineorder.part.p_brand1"}, profit:{$sum: "$dim"}}}]).toArray()' >>~/Documentos/benchmark/mongoDB/orderdatemo/query/shell/resultados/query43.txt

