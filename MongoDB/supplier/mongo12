#!/bin/bash
mongo localhost:27017/supplier --eval 'db.supplier.aggregate([{$match:{$and:[{"lineorder.orderdate.d_yearmonthnum": 199401},{"lineorder.lo_discount":{$in:[4,5,6]}},{"lineorder.lo_quantity":{$gte:26}},{"lineorder.lo_quantity":{$lte:35}}]}},{$unwind: "$lineorder"}, {$match:{$and:[{"lineorder.orderdate.d_yearmonthnum": 199401},{"lineorder.lo_discount":{$in:[4,5,6]}},{"lineorder.lo_quantity":{$gte:26}},{"lineorder.lo_quantity":{$lte:35}}]}},{$project:{"lineorder.orderdate.d_datekey":1, des:{$multiply:["$lineorder.lo_extendedprice","$lineorder.lo_discount",0.01]}}},{$group:{_id:null, revenue:{$sum:"$des"}}}]).toArray()' >>~/Documentos/benchmark/mongoDB/suppliermo/query/shell/resultados/query12.txt

