gc;connect remote:127.0.0.1/orderdate root rasns1901;select first(line.customer.c_city) as c_city, first(line.supplier.s_city) as s_city, d_year as year, sum(line.lo_revenue.asLong()) as revenue from (select d_year, lineorder as line from orderdate where d_yearmonthnum=199712 and lineorder.customer contains(c_city="UNITED KI1" or c_city="UNITED KI5") and lineorder.supplier contains(s_city="UNITED KI1" or s_city="UNITED KI5") unwind line) where line.customer contains(c_city="UNITED KI1" or c_city="UNITED KI5") and line.supplier contains(s_city="UNITED KI1" or s_city="UNITED KI5") group by line.customer.c_city, line.supplier.s_city, d_year
